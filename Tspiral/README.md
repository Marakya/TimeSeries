### Tspiral
Пакет python для прогнозирования временных рядов с использованием scikit-learn.

tspiral - это не библиотека, которая работает, как обертка для других инструментов и методов прогнозирования временных рядов. tspiral напрямую предоставляет оценщики scikit-learn для прогнозирования временных рядов. Он использует преимущества использования синтаксиса и компонентов scikit-learn для легкого доступа к системе с открытым исходным кодом, построенной на базе scikit-learn. Он легко отображает сложные задачи прогнозирования временных рядов в задачу табличной контролируемой регрессии, решая ее с помощью стандартных подходов.

### Обзор

tspiral предоставляет 4 оптимизированных метода прогнозирования:

#### Рекурсивное прогнозирование (Recursive Forecasting)
Целевые признаки объединяются с экзогенными экзогенными признаками (если они указаны). На все объединенные данные настраивается регрессор, совместимый с scikit-learn. Подобранный оценщик итеративно вызывается для прогнозирования на несколько шагов вперед.

### ![download](https://user-images.githubusercontent.com/113238801/203780266-d716ae54-9459-4c34-aba5-68b1f972f208.png)

Сгенерированные прогнозы на тестовых данных подтверждают наши опасения. Рекурсивные прогнозы выглядят хорошо на первых нескольких шагах, но к концу имеют тенденцию к исчезновению. С первой стороны, основной причиной такого медленного упадка является растущая величина ошибок прогнозирования, что приводит к появлению плохих запаздывающих характеристик. С другой стороны, изученные параметры модели не подходят для долгосрочного прогнозирования.

![download](https://user-images.githubusercontent.com/113238801/203780468-ef816d48-19de-403a-9857-c1a485038ac3.png)

#### Прямое прогнозирование (Direct Forecasting)
Прямой подход заключается в подборе отдельного оценщика для каждого временного шага, который мы хотим спрогнозировать.

![download](https://user-images.githubusercontent.com/113238801/203780498-390f383d-019e-47d3-b7f6-21af23e6054e.png)

По сравнению с рекурсивным прогнозированием, прямой подход строит независимые оценщики, которые специализируются на прогнозировании таргета с различными уровнями задержки. В нашем смоделированном случае она достигает отличных результатов. Прогнозы больше не исчезают со временем и, похоже, остаются стабильными до конца периода прогнозирования.

![download](https://user-images.githubusercontent.com/113238801/203780521-45fdb4a4-3da6-4f43-ac6e-e467e5c33851.png)

#### Stacking Forecasting

Несколько рекурсивных моделей временных рядов подгоняются и комбинируются на конечной части обучающих данных с помощью мета-обучающей модели.
Стекинг - это хорошо известная техника в машинном обучении. Она заключается в подгонке одного оценщика к прогнозам, полученным ранее (на другом разделе данных) с помощью других оценщиков. Применение методологии стекинга в системе временных рядов чрезвычайно просто. Нам нужно только позаботиться о том, чтобы генерировать и складывать прогнозы на самой последней части наших обучающих данных, чтобы сохранить временную зависимость.

![download](https://user-images.githubusercontent.com/113238801/203780597-7856147d-2015-4eaa-8e4d-cfd644adc246.png)

![download](https://user-images.githubusercontent.com/113238801/203780606-47401f6a-a5f7-4adc-aedc-9f0fa56ab4bf.png)

#### Rectified Forecasting

Этот подход можно рассматривать как сочетание прямого и рекурсивного подхода, а также как эволюцию стекирующего подхода. Вместо возможности обучать нескольких прогнозистов, мы генерируем рекурсивные прогнозы на разных группах обучения скользящего окна с помощью одной модели. Прогнозы, сгенерированные таким образом, затем корректируются на уровне временных шагов в соответствии с несколькими оценками. Надежда состоит в том, чтобы сгенерировать скорректированный (т.е. исправленный) окончательный прогноз.

![download](https://user-images.githubusercontent.com/113238801/203780646-adf9bbd3-50c6-4545-8f5d-0d576896d58e.png)

Многомерное прогнозирование временных рядов изначально поддерживается для всех доступных методов прогнозирования

![download](https://user-images.githubusercontent.com/113238801/203780666-f8dcdbc3-f26b-4519-941e-74aa492131ee.png)



