### Tspiral
Пакет python для прогнозирования временных рядов с использованием scikit-learn.

tspiral - это не библиотека, которая работает, как обертка для других инструментов и методов прогнозирования временных рядов. tspiral напрямую предоставляет оценщики scikit-learn для прогнозирования временных рядов. Он использует преимущества использования синтаксиса и компонентов scikit-learn для легкого доступа к системе с открытым исходным кодом, построенной на базе scikit-learn. Он легко отображает сложные задачи прогнозирования временных рядов в задачу табличной контролируемой регрессии, решая ее с помощью стандартных подходов.

### Обзор![download](https://user-images.githubusercontent.com/113238801/203780062-ed286ee3-eb47-48de-a1ea-dc3945688700.png)


tspiral предоставляет 4 оптимизированных метода прогнозирования:

#### Рекурсивное прогнозирование (Recursive Forecasting)
Целевые признаки объединяются с экзогенными экзогенными признаками (если они указаны). На все объединенные данные настраивается регрессор, совместимый с scikit-learn. Подобранный оценщик итеративно вызывается для прогнозирования на несколько шагов вперед.

![image.png](attachment:image.png)

Сгенерированные прогнозы на тестовых данных подтверждают наши опасения. Рекурсивные прогнозы выглядят хорошо на первых нескольких шагах, но к концу имеют тенденцию к исчезновению. С первой стороны, основной причиной такого медленного упадка является растущая величина ошибок прогнозирования, что приводит к появлению плохих запаздывающих характеристик. С другой стороны, изученные параметры модели не подходят для долгосрочного прогнозирования.

![image.png](attachment:image.png)

#### Прямое прогнозирование (Direct Forecasting)
Прямой подход заключается в подборе отдельного оценщика для каждого временного шага, который мы хотим спрогнозировать.

![image.png](attachment:image.png)

По сравнению с рекурсивным прогнозированием, прямой подход строит независимые оценщики, которые специализируются на прогнозировании таргета с различными уровнями задержки. В нашем смоделированном случае она достигает отличных результатов. Прогнозы больше не исчезают со временем и, похоже, остаются стабильными до конца периода прогнозирования.

![image.png](attachment:image.png)

#### Stacking Forecasting

Несколько рекурсивных моделей временных рядов подгоняются и комбинируются на конечной части обучающих данных с помощью мета-обучающей модели.
Стекинг - это хорошо известная техника в машинном обучении. Она заключается в подгонке одного оценщика к прогнозам, полученным ранее (на другом разделе данных) с помощью других оценщиков. Применение методологии стекинга в системе временных рядов чрезвычайно просто. Нам нужно только позаботиться о том, чтобы генерировать и складывать прогнозы на самой последней части наших обучающих данных, чтобы сохранить временную зависимость.

![image.png](attachment:image.png)

![image.png](attachment:image.png)

#### Rectified Forecasting

Этот подход можно рассматривать как сочетание прямого и рекурсивного подхода, а также как эволюцию стекирующего подхода. Вместо возможности обучать нескольких прогнозистов, мы генерируем рекурсивные прогнозы на разных группах обучения скользящего окна с помощью одной модели. Прогнозы, сгенерированные таким образом, затем корректируются на уровне временных шагов в соответствии с несколькими оценками. Надежда состоит в том, чтобы сгенерировать скорректированный (т.е. исправленный) окончательный прогноз.

![image.png](attachment:image.png)

Многомерное прогнозирование временных рядов изначально поддерживается для всех доступных методов прогнозирования

![image.png](attachment:image.png)


